(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     55808,       1482]
NotebookOptionsPosition[     54692,       1443]
NotebookOutlinePosition[     55062,       1459]
CellTagsIndexPosition[     55019,       1456]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["\:51f9\:9762\:955c\:5bf9\:5e73\:884c\:5149\:7684\:6298\:5c04"], \
"Input",
 CellChangeTimes->{{3.45333669115625*^9, 3.453336707125*^9}}],

Cell[BoxData["\:6b63\:5165\:5c04"], "Input",
 CellChangeTimes->{{3.45333671815625*^9, 3.453336719390625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", "=", "0.1"}], ";", 
  RowBox[{"a", "=", "2.0"}], ";", 
  RowBox[{"h", "=", "5.0"}], ";", 
  RowBox[{"zm", "=", 
   RowBox[{"-", "10.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", "1"}], ";", 
  RowBox[{"n2", "=", "2"}], ";", 
  RowBox[{"n3", "=", "1"}], ";", 
  RowBox[{"optical", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"{", 
      RowBox[{"zm", ",", "y0"}], "}"}]}], ";", 
    RowBox[{"p2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        SuperscriptBox["y0", "2"]}], ",", "y0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"k1", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"2", " ", "q", " ", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"2", " ", "q", " ", 
         RowBox[{"p2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"n2", "-", "n1"}], ")"}]}]}], ")"}], "/", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"2", " ", "q", " ", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", "n2", "-", "n1"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z3", "=", "a"}], ";", 
    RowBox[{"y3", "=", 
     RowBox[{
      RowBox[{"p2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z3", "-", 
         RowBox[{"p2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p3", "=", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "y3"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kz", "=", 
     RowBox[{"1", "/", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["k", "2"]}]]}]}], ";", 
    RowBox[{"ky", "=", 
     RowBox[{"k", " ", "kz"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k2", "=", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "ky"}], "}"}]}], ";", 
    RowBox[{"k", "=", 
     FractionBox[
      RowBox[{"n2", " ", 
       RowBox[{"k2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"k2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], 
      RowBox[{"n3", "-", "n2", "+", 
       RowBox[{"n2", " ", 
        SuperscriptBox[
         RowBox[{"k2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "2"]}]}]]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z4", "=", 
     RowBox[{"3", "a"}]}], ";", 
    RowBox[{"y4", "=", 
     RowBox[{
      RowBox[{"p3", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z4", "-", 
         RowBox[{"p3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p4", "=", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "y4"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.004", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}], "]"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"optical", ",", "g"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"y0", ",", 
     RowBox[{
      RowBox[{"-", "h"}], "/", "2"}], ",", 
     RowBox[{"h", "/", "2"}], ",", 
     RowBox[{"h", "/", "10"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "+", 
       RowBox[{"q", " ", 
        SuperscriptBox["y", "2"]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        SuperscriptBox["h", "2"]}], ",", 
       RowBox[{"2", "a"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "h"}], ",", "h"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "Thick"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", 
            SuperscriptBox["h", "2"]}], ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "h"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", 
            SuperscriptBox["h", "2"]}], ",", 
           RowBox[{"-", "h"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"optical", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "z4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "h"}], ",", "h"}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"optical", ",", "g", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQzdBwWy52/UtHhoYfqhBaTh9CJ5iAaYY2Owhf3AFC
i3pAxKeFQ+jGGIi4WD6Ev6wYQs+rgdCPWiDyBV0Qvkw/hA6fAqGlZ0DolXMg
dPUVCF3wE6JPlS0OTD9jh9DLeME0Q5U6hH9HF8J/ow+hF5pA6FexEPmEJAh/
bRaEH54PoUsLIPSeaoj8Uwjd4N4E4U9pgdCNvGlgcU9BMM3wTAxCb5OHiCsa
QPhcRhDalV9xE0g8QxhMM1zSgPAXa4NoAHXXl3c=
  "]],

Cell[BoxData[
 GraphicsBox[{
   {Thickness[0.004], 
    LineBox[{{-10., -2.5}, {-0.625, -2.5}, {2., -3.15625}, {
     6., -5.289583333333333}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -2.}, {-0.4, -2.}, {2., -2.48}, {
     6., -4.1466666666666665`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -1.5}, {-0.225, -1.5}, {2., -1.83375}, {
     6., -3.061371483375959}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -1.}, {-0.1, -1.}, {2., -1.21}, {
     6., -2.018080808080808}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -0.5}, {-0.025, -0.5}, {2., -0.6012500000000001}, {
     6., -1.0022525062656642`}}]}, 
   {Thickness[0.004], LineBox[{{-10., 0.}, {0., 0.}, {2., 0.}, {6., 0.}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.5}, {-0.025, 0.5}, {2., 0.6012500000000001}, {6., 
     1.0022525062656642`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.}, {-0.1, 1.}, {2., 1.21}, {6., 2.018080808080808}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.5}, {-0.225, 1.5}, {2., 1.83375}, {6., 
     3.061371483375959}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 2.}, {-0.4, 2.}, {2., 2.48}, {6., 4.1466666666666665`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 2.5}, {-0.625, 2.5}, {2., 3.15625}, {6., 
     5.289583333333333}}]}, GraphicsComplexBox[CompressedData["
1:eJxdVXtQVFUYX7iYqBiwV920jIcg5KPyPSh6DyhPoRXUCct8JIr4QKDHqIiZ
VIpFGKzgOEOKLmqGOvhAdITvK5n12aSWqCAkD2mMNBdcWJFHu+c7/uE9uztn
595zvvfv9/P6eF3sckeNRrPZ9rPvtJyQ9kEYVhB8SFcm4YW0hKyGGhknVm0z
dRol9InI8Ym4KWOO/U+mhMVjZxWPrZQx7HZz6uJkCdfVZ2j3nZFRsV+IlNB+
PMcoY1Vo+dg7/hJGhsS2TcmVyY5WwvXhVsN322RcEJPUY6x3RGPIRd/sJNt5
m7vrux3JT4SMI66kJR6Y64jdnkHSEx+Z7Po4YvwH+t5zA2T8aPSizGcmB9z7
lZQeXq1F1yxLYckMB/KTo8WUulUlK49r8NT76/N+nKkVdjUIubdaTc5abB06
Kb55ci9U7KxY/fYRd4zzGNYyc1k3kB937IiuN5cO6YY4/+LGyoHuWLq2xvbt
goJ091tTn7vhmHkNK63Oz6Gg5zPdqBQ3jDbM9brX0wnlwUuH+yW5YTi38wyq
7upijp50Ra1+58YxZivMDQhW2C5XLOYBW6GGG3bFwO6zCY//bQdjSFPe49BX
sZo/t4B+5LFP17GBeP5QVkxt61OYdmbDa5efuKA92vSVT4HydUGLzi/jktQG
7UH++ndzBuAabtgMS3/aXuSd1x89DmT8tcvTDP3bzPGfjOqPtmLZOvYEeFql
/TDgj5G6HYbHkDjNcPK3Mmfs6rWvFhgfVzghrrAv6g6WhTdLLeA97PDDZYF9
0d6uOI9/gOryCtabswIrfvgbVvfZf5Sd6oNePK4mCJ5lX07oUpnfWMuaoO3L
qv1zPJyQm+9tBNolzFjgO+fGhw2wJCjqmOdICT/PPPhr6JB6uLvc0nQwzRHn
8/7UAtXVAdcMWlFreuceFJgetXSZNPgtL0Q15O51S3jgp8Etybe6rd9Xgbw/
fHKoQw/oeL3+BG8eVxeU1uXeHzrvBmyKzvdeFN0JvWf8o6qfX4M7X7+e4tLP
Clt5flfgFM+vHcz64IYVoy9DTmKe7dMOh/lzE4T9cvWt9QEWSBn4YJLhNsJF
Y8KsE1GtoOfxlkMoj9cMhqLMExNjSiF1dmRSxOVHkByrMV3cfhL2LXF+I7Kp
BSp5HY7DOH7+IWzi/o9ACffTDPMHZwdN2lQIw3f5/leT2QAHJu7pibmfDxsn
ZAakra2DZH5+B/zMz1eB74S7U72yvwC/zZd2N968DlPkwe36q3Hwe3Jsx4OS
06B5aV0KNIr341L4e2WVuD+d7iv7hP0LZF+5JvznkX8lQcTnR/Ep+SL+copf
eZHfeMpPSRf5H6H8lWOiPlupPkq8qF8U1U/ZKOp7leqrqOqvdIr+5FN/lGzR
v3PUP2VoGfW3kfqrnBf930L9VzzFfPjTfCjfiPkZQvOjqOaLpYr520vzxxaL
+ZxN88k2iPmtpvllBjHfiTTfzInXvQmIi52Yq8CHhfDBXuBnJuGHNQt8rSV8
sSyBv7OEPzZM4HME4ZOp8MsCBb5XE75ZkcB/MuGfeQl+cCF+YCr+YB2CXzqI
X9ibgn/8iH9YheCn6cRPTMVfbIbgtyLiN1Yi+K+O+I+p+JK9J/i0gviUeQm+
3UN8y1R8zKwv8zVbKPg8kvicWQTfA/E9U+kBSxV6cZr0grkLPfElPWEqvWEq
PWI+Qq96SK+YSs+YSu+YSg+ZSi+ZSk+ZSm/ZCz1mCw8H9KuUmUrP2f/RpfSO

    "], {{}, {}, 
     TagBox[
      TooltipBox[
       {Thickness[Large], 
        LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
         18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
         35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
         52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
         69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
         86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
         102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115,
          116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126}]},
       RowBox[{
         RowBox[{
           RowBox[{"0.1`", " ", 
             SuperscriptBox["y", "2"]}], "+", "z"}], "\[Equal]", "0"}]],
      Annotation[#, 0.1 $CellContext`y^2 + $CellContext`z == 0, 
       "Tooltip"]& ]}], 
   {Thickness[Large], 
    LineBox[{{-2.5, 5.}, {2., 5.}, {2., -5.}, {-2.5, -5.}}]}},
  Axes->True,
  AxesStyle->Thickness[0.003],
  PlotRange->{{-10., 6.}, {-5., 5.}}]], "Output",
 CellChangeTimes->{3.5378292076865234`*^9}]
}, Open  ]],

Cell[BoxData["\:659c\:5165\:5c04"], "Input",
 CellChangeTimes->{{3.453336724875*^9, 3.453336725921875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q", "=", "0.1"}], ";", 
  RowBox[{"a", "=", "2.0"}], ";", 
  RowBox[{"h", "=", "5.0"}], ";", 
  RowBox[{"zm", "=", 
   RowBox[{"-", "10.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", "1"}], ";", 
  RowBox[{"n2", "=", "2"}], ";", 
  RowBox[{"n3", "=", "1"}], ";", 
  RowBox[{"optical", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"k0", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kz", "=", 
   RowBox[{"1", "/", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox["k0", "2"]}]]}]}], ";", 
  RowBox[{"ky", "=", 
   RowBox[{"k0", " ", "kz"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1", "=", 
   RowBox[{"{", 
    RowBox[{"kz", ",", "ky"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"{", 
      RowBox[{"zm", ",", "y0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "-", "y0"}], "\[Equal]", 
        RowBox[{"k0", " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", "zm"}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"q", " ", 
          SuperscriptBox["y", "2"]}], "+", "z"}], "\[Equal]", "0"}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"equ", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "y"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"m", "=", 
     RowBox[{"z", "/.", "s"}]}], ";", 
    RowBox[{"s", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "/.", "#"}], ")"}], "\[Equal]", 
         RowBox[{"Max", "[", "m", "]"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "y"}], "}"}], "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"2", " ", "q", " ", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"2", " ", "q", " ", 
         RowBox[{"p2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"n2", "-", "n1"}], ")"}]}]}], ")"}], "/", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"2", " ", "q", " ", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", "+", "n2", "-", "n1"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z3", "=", "a"}], ";", 
    RowBox[{"y3", "=", 
     RowBox[{
      RowBox[{"p2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z3", "-", 
         RowBox[{"p2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p3", "=", 
     RowBox[{"{", 
      RowBox[{"z3", ",", "y3"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kz", "=", 
     RowBox[{"1", "/", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["k", "2"]}]]}]}], ";", 
    RowBox[{"ky", "=", 
     RowBox[{"k", " ", "kz"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k2", "=", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "ky"}], "}"}]}], ";", 
    RowBox[{"k", "=", 
     FractionBox[
      RowBox[{"n2", " ", 
       RowBox[{"k2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"k2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], 
      RowBox[{"n3", "-", "n2", "+", 
       RowBox[{"n2", " ", 
        SuperscriptBox[
         RowBox[{"k2", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "2"]}]}]]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z4", "=", 
     RowBox[{"3", "a"}]}], ";", 
    RowBox[{"y4", "=", 
     RowBox[{
      RowBox[{"p3", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z4", "-", 
         RowBox[{"p3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p4", "=", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "y4"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.004", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}], "]"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"optical", ",", "g"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"y0", ",", 
     RowBox[{"-", "h"}], ",", 
     RowBox[{"h", "/", "4"}], ",", 
     RowBox[{"h", "/", "10"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"ContourPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"z", "+", 
       RowBox[{"q", " ", 
        SuperscriptBox["y", "2"]}]}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        SuperscriptBox["h", "2"]}], ",", 
       RowBox[{"2", "a"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"-", "h"}], ",", "h"}], "}"}], ",", 
     RowBox[{"ContourStyle", "\[Rule]", "Thick"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", 
            SuperscriptBox["h", "2"]}], ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"-", "h"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", 
            SuperscriptBox["h", "2"]}], ",", 
           RowBox[{"-", "h"}]}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"optical", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "z4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "h"}], ",", "h"}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"optical", ",", "g", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.44739084978125*^9, {3.44740527046875*^9, 3.447405295671875*^9}, {
   3.447405379453125*^9, 3.44740540975*^9}, {3.448834523125*^9, 
   3.448834546125*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ratnz"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Solve was unable to solve the system with inexact \
coefficients. The answer was obtained by solving a corresponding exact system \
and numericizing the result. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ratnz\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5378292129101562`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ratnz"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Solve was unable to solve the system with inexact \
coefficients. The answer was obtained by solving a corresponding exact system \
and numericizing the result. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ratnz\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.537829212913086*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ratnz"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Solve was unable to solve the system with inexact \
coefficients. The answer was obtained by solving a corresponding exact system \
and numericizing the result. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ratnz\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5378292129365234`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Solve :: \
ratnz\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5378292129433594`*^9}],

Cell[BoxData[
 GraphicsBox[{
   {Thickness[0.004], 
    LineBox[{{-10., -5.}, {-1.0275264114831613`, -3.2055052822966323`}, {
     2., -3.9852609517714646`}, {6., -6.19209359756613}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -4.5}, {-0.6966011250105152, -2.639320225002103}, {
     2., -3.1552319426671254`}, {6., -4.743937459871273}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -4.}, {-0.43560762610399983`, -2.0871215252208}, {
     2., -2.3993577195371136`}, {6., -3.442065326948713}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -3.5}, {-0.23960600441426114`, -1.5479212008828522`}, {
     2., -1.7000347557875004`}, {6., -2.245911204645117}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -3.}, {-0.10421191718201146`, -1.0208423834364022`}, {
     2., -1.0424216075169195`}, {6., -1.1244722551130204`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -2.5}, {-0.02551286084109509, -0.505102572168219}, {
     2., -0.41394744449333865`}, {6., -0.05318895495422371}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -2.}, {0., 0.}, {2., 0.19607843137254902`}, {6., 
     0.9880038972110582}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -1.5}, {-0.024512160180379248`, 0.4950975679639241}, {2., 
     0.7967796539764684}, {6., 2.0159698946358864`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -1.}, {-0.09618943233420299, 0.9807621135331595}, {2., 
     1.395965882109123}, {6., 3.045278863301161}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., -0.5}, {-0.21243444677047046`, 1.4575131106459058`}, {2., 
     2.000338961385319}, {6., 4.088882889115251}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.}, {-0.37087982163739924`, 1.9258240356725203`}, {2., 
     2.615662039008288}, {6., 5.158653099340883}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.5}, {-0.5693606237084716, 2.3861278752583055`}, {2., 
     3.246899187561652}, {6., 6.265838100962025}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.}, {-0.8058909292494519, 2.83882181415011}, {2., 
     3.8983313718589514`}, {6., 7.421488914709554}}]}, 
   GraphicsComplexBox[CompressedData["
1:eJxdVXtQVFUYX7iYqBiwV920jIcg5KPyPSh6DyhPoRXUCct8JIr4QKDHqIiZ
VIpFGKzgOEOKLmqGOvhAdITvK5n12aSWqCAkD2mMNBdcWJFHu+c7/uE9uztn
595zvvfv9/P6eF3sckeNRrPZ9rPvtJyQ9kEYVhB8SFcm4YW0hKyGGhknVm0z
dRol9InI8Ym4KWOO/U+mhMVjZxWPrZQx7HZz6uJkCdfVZ2j3nZFRsV+IlNB+
PMcoY1Vo+dg7/hJGhsS2TcmVyY5WwvXhVsN322RcEJPUY6x3RGPIRd/sJNt5
m7vrux3JT4SMI66kJR6Y64jdnkHSEx+Z7Po4YvwH+t5zA2T8aPSizGcmB9z7
lZQeXq1F1yxLYckMB/KTo8WUulUlK49r8NT76/N+nKkVdjUIubdaTc5abB06
Kb55ci9U7KxY/fYRd4zzGNYyc1k3kB937IiuN5cO6YY4/+LGyoHuWLq2xvbt
goJ091tTn7vhmHkNK63Oz6Gg5zPdqBQ3jDbM9brX0wnlwUuH+yW5YTi38wyq
7upijp50Ra1+58YxZivMDQhW2C5XLOYBW6GGG3bFwO6zCY//bQdjSFPe49BX
sZo/t4B+5LFP17GBeP5QVkxt61OYdmbDa5efuKA92vSVT4HydUGLzi/jktQG
7UH++ndzBuAabtgMS3/aXuSd1x89DmT8tcvTDP3bzPGfjOqPtmLZOvYEeFql
/TDgj5G6HYbHkDjNcPK3Mmfs6rWvFhgfVzghrrAv6g6WhTdLLeA97PDDZYF9
0d6uOI9/gOryCtabswIrfvgbVvfZf5Sd6oNePK4mCJ5lX07oUpnfWMuaoO3L
qv1zPJyQm+9tBNolzFjgO+fGhw2wJCjqmOdICT/PPPhr6JB6uLvc0nQwzRHn
8/7UAtXVAdcMWlFreuceFJgetXSZNPgtL0Q15O51S3jgp8Etybe6rd9Xgbw/
fHKoQw/oeL3+BG8eVxeU1uXeHzrvBmyKzvdeFN0JvWf8o6qfX4M7X7+e4tLP
Clt5flfgFM+vHcz64IYVoy9DTmKe7dMOh/lzE4T9cvWt9QEWSBn4YJLhNsJF
Y8KsE1GtoOfxlkMoj9cMhqLMExNjSiF1dmRSxOVHkByrMV3cfhL2LXF+I7Kp
BSp5HY7DOH7+IWzi/o9ACffTDPMHZwdN2lQIw3f5/leT2QAHJu7pibmfDxsn
ZAakra2DZH5+B/zMz1eB74S7U72yvwC/zZd2N968DlPkwe36q3Hwe3Jsx4OS
06B5aV0KNIr341L4e2WVuD+d7iv7hP0LZF+5JvznkX8lQcTnR/Ep+SL+copf
eZHfeMpPSRf5H6H8lWOiPlupPkq8qF8U1U/ZKOp7leqrqOqvdIr+5FN/lGzR
v3PUP2VoGfW3kfqrnBf930L9VzzFfPjTfCjfiPkZQvOjqOaLpYr520vzxxaL
+ZxN88k2iPmtpvllBjHfiTTfzInXvQmIi52Yq8CHhfDBXuBnJuGHNQt8rSV8
sSyBv7OEPzZM4HME4ZOp8MsCBb5XE75ZkcB/MuGfeQl+cCF+YCr+YB2CXzqI
X9ibgn/8iH9YheCn6cRPTMVfbIbgtyLiN1Yi+K+O+I+p+JK9J/i0gviUeQm+
3UN8y1R8zKwv8zVbKPg8kvicWQTfA/E9U+kBSxV6cZr0grkLPfElPWEqvWEq
PWI+Qq96SK+YSs+YSu+YSg+ZSi+ZSk+ZSm/ZCz1mCw8H9KuUmUrP2f/RpfSO

    "], {{}, {}, 
     TagBox[
      TooltipBox[
       {Thickness[Large], 
        LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 
         18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
         35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 
         52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 
         69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 
         86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
         102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115,
          116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126}]},
       RowBox[{
         RowBox[{
           RowBox[{"0.1`", " ", 
             SuperscriptBox["y", "2"]}], "+", "z"}], "\[Equal]", "0"}]],
      Annotation[#, 0.1 $CellContext`y^2 + $CellContext`z == 0, 
       "Tooltip"]& ]}], 
   {Thickness[Large], 
    LineBox[{{-2.5, 5.}, {2., 5.}, {2., -5.}, {-2.5, -5.}}]}},
  Axes->True,
  AxesStyle->Thickness[0.003],
  PlotRange->{{-10., 6.}, {-5., 5.}}]], "Output",
 CellChangeTimes->{3.5378292130498047`*^9}]
}, Open  ]],

Cell[BoxData["\:4e09\:68f1\:955c\:5bf9\:5e73\:884c\:5149\:7684\:6298\:5c04"], \
"Input",
 CellChangeTimes->{{3.45333667046875*^9, 3.453336679109375*^9}}],

Cell[BoxData["\:5e73\:884c\:5149\:5165\:5c04"], "Input",
 CellChangeTimes->{{3.45333674821875*^9, 3.453336750796875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "5.0"}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"\[Pi]", "/", "4.0"}]}], ";", 
  RowBox[{"h", "=", 
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"Cot", "[", 
      RowBox[{"\[Alpha]", "/", "2"}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zm", "=", 
   RowBox[{
    RowBox[{"-", "2"}], "a"}]}], ";", 
  RowBox[{"k0", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", "1"}], ";", 
  RowBox[{"n2", "=", "1.5"}], ";", 
  RowBox[{"n3", "=", "1"}], ";", 
  RowBox[{"optical", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kz", "=", 
   RowBox[{"1", "/", 
    SqrtBox[
     RowBox[{"1", "+", 
      SuperscriptBox["k0", "2"]}]]}]}], ";", 
  RowBox[{"ky", "=", 
   RowBox[{"k0", " ", "kz"}]}], ";", 
  RowBox[{"k1", "=", 
   RowBox[{"{", 
    RowBox[{"kz", ",", "ky"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", "=", 
     RowBox[{"{", 
      RowBox[{"zm", ",", "y0"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equ1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "-", "y0"}], "\[Equal]", 
        RowBox[{"k0", " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", "zm"}], ")"}]}]}], ",", 
       RowBox[{"y", "\[Equal]", 
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"z", "+", 
           RowBox[{"a", "/", "2"}]}], ")"}]}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"equ1", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "y"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "y"}], "}"}], "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n2", "-", "n1"}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "\[IndentingNewLine]", 
      "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"n1", "-", "n2"}], ")"}]}], "+", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
            RowBox[{"k1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], " ", "n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equ2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "==", 
        RowBox[{
         RowBox[{"p2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"y", "\[Equal]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cot", "[", 
           RowBox[{"\[Alpha]", "/", "2"}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"a", "/", "2"}]}], ")"}]}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"equ2", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "y"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p3", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "y"}], "}"}], "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kz", "=", 
     RowBox[{"1", "/", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["k", "2"]}]]}]}], ";", 
    RowBox[{"ky", "=", 
     RowBox[{"k", " ", "kz"}]}], ";", 
    RowBox[{"k2", "=", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "ky"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n3", "-", "n2"}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
            RowBox[{"k2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n2", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "\[IndentingNewLine]", 
      "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"n3", "-", "n2"}], ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], " ", 
            RowBox[{"k2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n2", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z4", "=", "a"}], ";", 
    RowBox[{"y4", "=", 
     RowBox[{
      RowBox[{"p3", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z4", "-", 
         RowBox[{"p3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p4", "=", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "y4"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.004", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}], "]"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"optical", ",", "g"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"y0", ",", "0", ",", 
     RowBox[{"h", "/", "2"}], ",", 
     RowBox[{"h", "/", "20"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "/", "2"}], ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "/", "2"}], ",", "0"}], "}"}]}], "}"}], 
       "]"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"optical", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "z4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.2"}], "h"}], ",", 
        RowBox[{"1.2", "h"}]}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"optical", ",", "g", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.447384310859375*^9, 3.447384367765625*^9}, {
   3.447384440953125*^9, 3.447384483015625*^9}, {3.4473845641875*^9, 
   3.447384576734375*^9}, {3.447384640671875*^9, 3.4473847646875*^9}, {
   3.44738480403125*^9, 3.447384952703125*^9}, {3.4473849891875*^9, 
   3.4473850609375*^9}, {3.4473851270625*^9, 3.447385171515625*^9}, {
   3.447385208875*^9, 3.44738525071875*^9}, {3.44738528084375*^9, 
   3.44738531728125*^9}, {3.44738576384375*^9, 3.4473860595*^9}, {
   3.447386161171875*^9, 3.447386175203125*^9}, {3.447386221203125*^9, 
   3.4473864278125*^9}, {3.447386478890625*^9, 3.447386495375*^9}, {
   3.44738653303125*^9, 3.4473868633125*^9}, {3.447386899015625*^9, 
   3.44738696540625*^9}, {3.447387002734375*^9, 3.447387011671875*^9}, {
   3.447387101890625*^9, 3.44738710315625*^9}, {3.447387154234375*^9, 
   3.447387172625*^9}, {3.44739703953125*^9, 3.44739712625*^9}, {
   3.447397216859375*^9, 3.44739724253125*^9}, {3.447397274625*^9, 
   3.44739738053125*^9}, {3.44739744028125*^9, 3.447397463203125*^9}, {
   3.44739760625*^9, 3.447397614890625*^9}, {3.44739765596875*^9, 
   3.4473977635*^9}, {3.447397843875*^9, 3.44739785415625*^9}, {
   3.447397902359375*^9, 3.447397985015625*^9}, {3.44739802040625*^9, 
   3.44739806490625*^9}, {3.447398097109375*^9, 3.44739818784375*^9}, 
   3.447398232953125*^9, {3.447398298109375*^9, 3.44739829940625*^9}, {
   3.4473983560625*^9, 3.447398365328125*^9}, {3.447398397328125*^9, 
   3.447398459953125*^9}, {3.447398515421875*^9, 3.447398516015625*^9}, {
   3.447398881484375*^9, 3.447398890203125*^9}, {3.4473989848125*^9, 
   3.4473990138125*^9}, {3.44739904584375*^9, 3.44739909403125*^9}, {
   3.447399150390625*^9, 3.447399151140625*^9}, {3.447399296640625*^9, 
   3.447399353046875*^9}, {3.447399564546875*^9, 3.447399565578125*^9}, {
   3.447399600546875*^9, 3.44739968534375*^9}, {3.4473997484375*^9, 
   3.447399805890625*^9}, {3.447400438671875*^9, 3.44740045846875*^9}, {
   3.447400501046875*^9, 3.447400612234375*^9}, {3.447400643421875*^9, 
   3.44740067834375*^9}, {3.447400714953125*^9, 3.4474008360625*^9}, {
   3.44740087265625*^9, 3.4474009244375*^9}, {3.447406263984375*^9, 
   3.44740646625*^9}, {3.447409975015625*^9, 3.44740999196875*^9}, {
   3.44741006246875*^9, 3.447410079265625*^9}, {3.44883492771875*^9, 
   3.448835023703125*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {Thickness[0.004], 
    LineBox[{{-10., 0.}, {-2.175915822033764, 0.7824084177966236}, {
     2.320108569333375, 0.4342963316700658}, {5., -0.471610913113411}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.3017766952966369}, {-2.04551441906766, 
     1.097225253389871}, {2.181065776679764, 0.7699753274446439}, {
     5., -0.18293377411498613`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.6035533905932738}, {-1.915113016101556, 
     1.4120420889831184`}, {2.0420229840261523`, 1.1056543232192222`}, {5., 
     0.10574336488343872`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 0.9053300858899107}, {-1.7847116131354521`, 
     1.7268589245763655`}, {1.9029801913725417`, 1.4413333189938}, {5., 
     0.39442050388186356`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.2071067811865477`}, {-1.6543102101693479`, 
     2.041675760169613}, {1.7639373987189304`, 1.7770123147683785`}, {5., 
     0.6830976428802886}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.5088834764831847`}, {-1.523908807203244, 
     2.35649259576286}, {1.6248946060653195`, 2.112691310542956}, {5., 
     0.9717747818787132}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 1.8106601717798214`}, {-1.39350740423714, 
     2.671309431356107}, {1.4858518134117085`, 2.448370306317534}, {5., 
     1.260451920877138}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 2.1124368670764584`}, {-1.2631060012710362`, 
     2.9861262669493547`}, {1.3468090207580972`, 2.784049302092112}, {5., 
     1.5491290598755627`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 2.4142135623730954`}, {-1.1327045983049322`, 
     3.300943102542602}, {1.207766228104486, 3.1197282978666903`}, {5., 
     1.8378061988739876`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 2.7159902576697323`}, {-1.0023031953388282`, 
     3.6157599381358496`}, {1.068723435450875, 3.4554072936412683`}, {5., 
     2.126483337872412}}]}, 
   {Thickness[0.004], 
    LineBox[{{-10., 3.0177669529663693`}, {-0.8719017923727244, 
     3.9305767737290966`}, {0.9296806427972639, 3.7910862894158464`}, {5., 
     2.4151604768708372`}}]}, 
   {Thickness[Large], 
    LineBox[{{-2.5, 0}, {0, 6.035533905932738}, {2.5, 0}, {-2.5, 0}}]}},
  Axes->True,
  AxesStyle->Thickness[0.003],
  PlotRange->{{-10., 5.}, {-1.2071067811865477`, 
   7.242640687119285}}]], "Output",
 CellChangeTimes->{3.5378292165595703`*^9}]
}, Open  ]],

Cell[BoxData["\:70b9\:5149\:6e90\:5165\:5c04"], "Input",
 CellChangeTimes->{{3.453336756890625*^9, 3.453336759734375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "2.0"}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"\[Pi]", "/", "3"}]}], ";", 
  RowBox[{"h", "=", 
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"Cot", "[", 
      RowBox[{"\[Alpha]", "/", "2"}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zm", "=", 
   RowBox[{
    RowBox[{"-", "2"}], "a"}]}], ";", 
  RowBox[{"\[Theta]m", "=", 
   RowBox[{"5", " ", 
    RowBox[{"\[Pi]", "/", "180.0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1", "=", "1"}], ";", 
  RowBox[{"n2", "=", "1.5"}], ";", 
  RowBox[{"n3", "=", "1"}], ";", 
  RowBox[{"optical", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"{", 
    RowBox[{"zm", ",", 
     RowBox[{"h", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kz", "=", 
     RowBox[{"1", "/", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["k", "2"]}]]}]}], ";", 
    RowBox[{"ky", "=", 
     RowBox[{"k", " ", "kz"}]}], ";", 
    RowBox[{"k1", "=", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "ky"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"equ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"y", "-", 
         RowBox[{"p1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", 
        RowBox[{"k", 
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"p1", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"y", "\[Equal]", 
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"z", "+", 
           RowBox[{"a", "/", "2"}]}], ")"}]}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"equ", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "y"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p2", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "y"}], "}"}], "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n2", "-", "n1"}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
            RowBox[{"k1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "\[IndentingNewLine]", 
      "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"n1", "-", "n2"}], ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
            RowBox[{"k1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n1", " ", 
         RowBox[{"k1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"equ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"y", "==", 
        RowBox[{
         RowBox[{"p2", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"z", "-", 
            RowBox[{"p2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"y", "\[Equal]", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cot", "[", 
           RowBox[{"\[Alpha]", "/", "2"}], "]"}]}], 
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"a", "/", "2"}]}], ")"}]}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"s", "=", 
     RowBox[{"Solve", "[", 
      RowBox[{"equ", ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "y"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"p3", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "y"}], "}"}], "/.", 
      RowBox[{"s", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"kz", "=", 
     RowBox[{"1", "/", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["k", "2"]}]]}]}], ";", 
    RowBox[{"ky", "=", 
     RowBox[{"k", " ", "kz"}]}], ";", 
    RowBox[{"k2", "=", 
     RowBox[{"{", 
      RowBox[{"kz", ",", "ky"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"k", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n3", "-", "n2"}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
            RowBox[{"k2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n2", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "\[IndentingNewLine]", 
      "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cot", "[", 
          RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"n3", "-", "n2"}], ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"k2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Cot", "[", 
             RowBox[{"\[Alpha]", "/", "2"}], "]"}], 
            RowBox[{"k2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "n2", " ", 
         RowBox[{"k2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"z4", "=", "a"}], ";", 
    RowBox[{"y4", "=", 
     RowBox[{
      RowBox[{"p3", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"z4", "-", 
         RowBox[{"p3", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"p4", "=", 
     RowBox[{"{", 
      RowBox[{"z4", ",", "y4"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.004", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "}"}], "]"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"optical", ",", "g"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", 
     RowBox[{"-", "\[Theta]m"}], ",", "\[Theta]m", ",", 
     RowBox[{"\[Theta]m", "/", "4"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "h"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "/", "2"}], ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "a"}], "/", "2"}], ",", "0"}], "}"}]}], "}"}], 
       "]"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"optical", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"optical", ",", 
   RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "0.003", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zm", ",", "z4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "0.5"}], "h"}], ",", 
        RowBox[{"1.2", "h"}]}], "}"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"optical", ",", "g", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.447384310859375*^9, 3.447384367765625*^9}, {
   3.447384440953125*^9, 3.447384483015625*^9}, {3.4473845641875*^9, 
   3.447384576734375*^9}, {3.447384640671875*^9, 3.4473847646875*^9}, {
   3.44738480403125*^9, 3.447384952703125*^9}, {3.4473849891875*^9, 
   3.4473850609375*^9}, {3.4473851270625*^9, 3.447385171515625*^9}, {
   3.447385208875*^9, 3.44738525071875*^9}, {3.44738528084375*^9, 
   3.44738531728125*^9}, {3.44738576384375*^9, 3.4473860595*^9}, {
   3.447386161171875*^9, 3.447386175203125*^9}, {3.447386221203125*^9, 
   3.4473864278125*^9}, {3.447386478890625*^9, 3.447386495375*^9}, {
   3.44738653303125*^9, 3.4473868633125*^9}, {3.447386899015625*^9, 
   3.44738696540625*^9}, {3.447387002734375*^9, 3.447387011671875*^9}, {
   3.447387101890625*^9, 3.44738710315625*^9}, {3.447387154234375*^9, 
   3.447387172625*^9}, {3.44739703953125*^9, 3.44739712625*^9}, {
   3.447397216859375*^9, 3.44739724253125*^9}, {3.447397274625*^9, 
   3.44739738053125*^9}, {3.44739744028125*^9, 3.447397463203125*^9}, {
   3.44739760625*^9, 3.447397614890625*^9}, {3.44739765596875*^9, 
   3.4473977635*^9}, {3.447397843875*^9, 3.44739785415625*^9}, {
   3.447397902359375*^9, 3.447397985015625*^9}, {3.44739802040625*^9, 
   3.44739806490625*^9}, {3.447398097109375*^9, 3.44739818784375*^9}, 
   3.447398232953125*^9, {3.447398298109375*^9, 3.44739829940625*^9}, {
   3.4473983560625*^9, 3.447398365328125*^9}, {3.447398397328125*^9, 
   3.447398459953125*^9}, {3.447398515421875*^9, 3.447398516015625*^9}, {
   3.447398881484375*^9, 3.447398890203125*^9}, {3.4473989848125*^9, 
   3.4473990138125*^9}, {3.44739904584375*^9, 3.44739909403125*^9}, {
   3.447399150390625*^9, 3.447399151140625*^9}, {3.447399296640625*^9, 
   3.447399353046875*^9}, {3.447399564546875*^9, 3.447399565578125*^9}, {
   3.447399600546875*^9, 3.44739968534375*^9}, {3.4473997484375*^9, 
   3.447399805890625*^9}, {3.4473999549375*^9, 3.447400180875*^9}, {
   3.44740653640625*^9, 3.44740657834375*^9}, {3.4474066183125*^9, 
   3.447406650953125*^9}, {3.447406698328125*^9, 3.4474067075*^9}, {
   3.447410444125*^9, 3.4474104750625*^9}, {3.4488353108125*^9, 
   3.448835359765625*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.6682900136024474, 
     0.5745385498185424}, {0.8898335694958027, 0.1908138549217754}, {
     2., -0.7236682316223089}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.6276161832693838, 
     0.6449876904938444}, {0.822167323279709, 0.30801523132551506`}, {
     2., -0.6171110111334603}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.5860574922358368, 
     0.716969454860005}, {0.7555694611387129, 0.42336611222918813`}, {
     2., -0.5089881061766839}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.543543839128845, 
     0.7906052620566733}, {0.6898950987033378, 0.5371174447219508}, {
     2., -0.3994678448028044}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.5, 0.8660254037844386}, {0.625, 
     0.6495190528383289}, {2., -0.288675134594813}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.45534504769429446`, 
     0.9433700499874856}, {0.560739369667561, 0.760821729500515}, {
     2., -0.17669720524064014`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.40949169775398286`, 
     1.0227903817813406`}, {0.49696658645488867`, 0.871279430164939}, {
     2., -0.06358810788307978}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.3623455692676552, 
     1.1044498716998306`}, {0.4335318549012442, 0.981151608180344}, {2., 
     0.050627819265845586`}}]}, 
   {Thickness[0.004], 
    LineBox[{{-4., 0.8660254037844386}, {-0.3138043469807996, 
     1.1885257349621592`}, {0.3702807491440052, 1.090705736986794}, {2., 
     0.1659533608619006}}]}, 
   {Thickness[Large], 
    LineBox[{{-1., 0}, {0, 1.7320508075688772`}, {1., 0}, {-1., 0}}]}},
  Axes->True,
  AxesStyle->Thickness[0.003],
  PlotRange->{{-4., 2.}, {-0.8660254037844386, 
   2.0784609690826525`}}]], "Output",
 CellChangeTimes->{3.5378292194472656`*^9}]
}, Open  ]]
},
WindowToolbars->"EditBar",
WindowSize->{1272, 683},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 150, 2, 31, "Input"],
Cell[698, 24, 109, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[832, 29, 7122, 210, 673, "Input"],
Cell[7957, 241, 4205, 84, 236, "Output"]
}, Open  ]],
Cell[12177, 328, 107, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[12309, 333, 8163, 244, 789, "Input"],
Cell[20475, 579, 525, 11, 24, "Message"],
Cell[21003, 592, 523, 11, 24, "Message"],
Cell[21529, 605, 525, 11, 24, "Message"],
Cell[22057, 618, 531, 11, 24, "Message"],
Cell[22591, 631, 4986, 95, 236, "Output"]
}, Open  ]],
Cell[27592, 729, 153, 2, 31, "Input"],
Cell[27748, 733, 121, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[27894, 738, 11027, 294, 776, "Input"],
Cell[38924, 1034, 2391, 51, 214, "Output"]
}, Open  ]],
Cell[41330, 1088, 122, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[41477, 1093, 11205, 302, 816, "Input"],
Cell[52685, 1397, 1991, 43, 190, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
