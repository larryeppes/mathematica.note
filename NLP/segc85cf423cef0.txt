入门手册
服务器配置
字数
重要说明
本方是翻译自
这个文章
感谢
这些原文作者的写作成果
让我们能更好地入门学习
的相关技术
考虑到国内中文的文档资料比较欠缺
而且基本不太成体系
所以自己希望来翻译该文章
方便学习使用
以下是原文内容的翻译
一些关键性的技术术语
本文考虑不进行翻译
保持原来的英文词汇
加强技术术语印象
而且这些技术术语强行翻译成中文的话
感觉很别扭
另一方面水平有限
文本可能有翻译不太贴切或是错误的地方
还请大家体谅
看到后多多指正
目录
服务器配置
功能启用
禁用
数据库配置
添加自定义
驱动
安全性
启用
传统认证
配置
管理端点的安全性
监控和管理
管理
监控部署的应用程序
日志和
指标器
以下是原文内容的翻译
你可以自己使用这个文章或是分发给其它人
但前提是你不以赚取费用为目标
同时每个转发的文章必须包含此版权通知
无论是印刷品版本还是电子发行版本
服务器配置
在本节中
您将学习如何配置
服务器的功能
如关系型数据库的使用和安全性配置
您还将学习如何配置
的
命令行工具的功能
功能启用
禁用
数据流服务器提供了一组特定功能
可以在启动时启用
禁用这些功能特性
这些特性包括全生命周期的操作
接口风格的端点
服务器
基于
或
的客户端
分析
在启动数据流服务器时
可以通过设置以下布尔属性来启用
禁用这些特性
默认情况下
所有功能都会启用
注意
由于分析功能是默认启用的
所以数据流服务器需要有一个
存储作为数据分析库
我们提供一个默认的基于
的分析功能实现类
这也意味着数据流服务器的健康状态取决于
存储的可用性
如果你不想启用
端点来读取
库里的那些数据
可以使用上边的属性配置来禁用分析功能
风格的端点
提供了的功能启用
禁用的状态信息
数据库配置
关系数据库用于存储
和
的定义以及
的执行状态
为
提供了相应的数据架构
在服务器启动时将会自动创建相应的数据库和表结构
本身提供了
数据库的嵌入式实例
可以直接在开发环境当中使用
但不推荐用于生产环境
使用
的驱动
的
驱动程序
和嵌入式
一样
也是开箱即用的
平台本身已经自带相应的驱动
如果你正在使用其他的数据库
那么相应的
驱动程序
包需要存放在服务器的对应
里
数据库属性可以作为环境变量或命令行参数传递给数据流服务器
环境变量
如果你使用的是
命令行参数是
如果你使用的是
命令行参数是
如果你使用的是
命令行参数是
数据存储升级版
到
的时候
需要升级新的数据架构到
具体数据库类型的迁移脚本的可以在相应的位置找到
如果你想使用一个外部的
数据库实例而不是一个嵌入式的
设置
的
属性为
如果
属性为
或者指定了其他数据库类型作为数据源
那么
嵌入式数据库是不会启用的
添加自定义
驱动
为数据库添加自定义驱动程序
如
建议您重新编译数据流服务器
在
的
文件中添加依赖
每个目标平台都有
服务器的对应版本
您需要针对每个平台修改相应版本的
文件
在每个
库中有每个服务器版本对应的标签
为本地服务器添加自定义
驱动的依赖
包
选择你需要重新编译的对应服务器版本的标签
在
库里进行克隆
编辑
文件
在
部分添加数据库驱动程序所需的的依赖
在下面的示例中
选定了
驱动程序
重新编译
具体内容查看
在重新编译
的时候
可以通过设置
文件中的属性
给相应的版本设置属性的默认值
如
像下边这样来设置
这个属性的默认值
安全性
默认情况下
数据流服务器是不安全的
运行在一个未加密的
连接上
通过启用
并要求客户端使用以下两种身份验证
您可以确保
端点以及数据流仪表板的安全性
认证
传统认证方式
如
认证
认证选项
当选择
传统认证
服务器将成为主要的认证点
使用
作为基础
当选择此选项时
用户需要进一步定义他们首选的认证机制
选择所需的后台认证存储
单用户认证
认证
基于文件认证
传统认证
或
之间进行选择的时候
记住这两个选项是互斥的
请看下面的子章节进行更详细的讨论
默认情况下
端点
用于管理和状态查看
以及仪表板
不需要经过身份验证就可以访问
启用
默认情况下
仪表板
管理
和状态端点使用
作为传输协议
你可以很容易地将他们切换到
在
配置文件中添加证书
默认端口是
你可以修改端口为更常见的
典型端口
如果启用了
它将完全替代
作为
端点和数据流仪表板交互的协议
普通
请求将失败
因此
请确保您相应地启用了
命令行
使用自签名证书
为了测试目的或在开发阶段
创建自签名证书很方便
请执行以下命令来创建证书
是这里唯一重要的参数
它是使用的域名
如
然后添加以下内容到你
的
文件里
这是数据流服务器所需要的配置
一旦你启动服务器
你应该能够访问
由于这是一个自签名证书
您将在浏览器中看到一个警告
需要忽略它
自签名证书和
默认情况下
自签名证书会影响
的正常使用
需要额外的配置步骤来使
可以结合自签名证书工作
有两种方法可以实现
添加自签名证书到
的信任库中
跳过证书验证
添加自签名证书到
的信任库
我们需要从密钥库导出以前创建的证书
接下来
我们需要创建一个
使用的密钥库
现在你可以使用以下的命令行来启动
的
不要忘记设置目标服务器的正确
跳过证书验证
或者
你也可以通过提供可选的命令行参数
来跳过验证
使用此命令行参数后
将接受任何
自签名
证书
如果可能的话
你应该避免使用此选项
禁用信任管理器会就失去了
的意义
并容易受到攻击
传统认证
当使用
传统认证时
将是唯一的身份验证提供程序
在这种情况下
数据流的
用户会使用
基本认证来访问端点
使用该选项时
用户可以选择
种后备存储来完成认证
单用户认证
使用
的属性
基于
文件的多用户认证
认证
单用户认证
这是最简单的选项
模拟了默认的
用户体验行为
它可以通过添加以下属性到应用程序的
文件或环境变量来启用
启用基本身份验证
必须将安全属性设置为
可选
基本身份验证领域将默认
为
如果没有设置的话
在当前案例中
启动时会自动创建一个用户叫
并自动生成密码
这些信息会被打印到控制台上
采用这个配置所产生的用户
将分配所有主要的角色权限
默认的
用户凭证
你可以使用以下属性来自定义用户的相关信息
请注意基本身份验证本身固有的问题
由于凭据被浏览器缓存
浏览网页进行回退到应用程序的页面
你会自动登录进入系统
当然
您也可以使用系统属性
环境变量或命令行参数传递认证信息
这些都是
支持的标准方法
例如
在下面的示例中
使用命令行参数来指定用户凭据
如果你需要定义多个基于文件的用户帐号
请看看基于文件的认证
基于文件的认证
默认情况下
只允许设置一个用户
还支持在配置文件中设置多个用户
如下所述
每个用户必须指定一个密码
一个或多个角色
认证
还支持使用
服务器
轻量级目录访问协议
的身份验证
支持以下
种模式
直接绑定
搜索和绑定
当
身份验证选项被激活时
默认的单用户认证模式将被关闭
在采用直接绑定模式时
认证模式是使用用户定义的可分辨名称
它是使用占位符的用户名
身份验证过程通过替换占位符派生出用户的专有名称
并使用它在
服务器上进行用户身份验证
同时提供所需要的密码
您可以设置
直接绑定如下
采用搜索绑定
模式时
先以匿名方式或一个固定的账户连接到
服务器
然后基于用户名的标识来寻找认证用户
然后使用查找到的用户名和相应的密码绑定到
服务器
此选项配置如下
传输安全
当连接到
服务器时
通常
在
的环境中
有
个选项
可以支持建立到
服务器的安全连接
只默认直接支持
其它的需要单独配置
使用官方证书时
不需要特殊的配置
为了通过
连接到
服务器
只需改变
的格式
采用
格式即可
例如
在使用自签名证书的情况下
服务器的设置变得稍微复杂一些
相应的配置与
服务器使用自签名证书配置非常相似
也就是
需要基于一个
才能正常运行
这样的配置适合在开发和测试期间使用
但请不要在生产中使用自签名证书
不然信任问题不少
最后
还必须提供一套关于
的配置参数与凭据来启动服务器
正如上面提到的
另一个连接
服务器的安全选项是通过
虽然
受到更多人的青睐
以至于
技术被认为是重复
没必要的
然而
目前并不是
能直接支持的
至于如何配置的问题
还需要去查看相关的资料
认证
当使用
认证的时候
你可以直接在命令行参数当中直接提供相应的用户名与密码
如果开启了认证
那么用户名是必须要提供的
如果没有提供相应的密码
那么控制台会进行提示
需要你输入相应的密码
你可以在使用
时直接指定相应的
服务器
自定义授权
除了上边所讲的关于认证的配置外
也可以配置自定义授权
确定什么角色可以做什么
默认的方案使用三个角色来保护
暴露的
风格的端点
查看系统各种状态
创建
删除或是修改系统的状态
启动与管理端点
所有这些默认值都是在
文件里设置的
这配置也是
的核心模块
如果有需要的话
你也可以在
文件里重写这些配置
这些配置采用了
列表的形式
一些规则可能优先于其他的
所以你需要复制
粘贴整个列表来定制你的需求
没有办法合并列表
默认的规则是这样的
每一行的格式是这样的
的请求方式
大写
风格的
表达式
这些元素都需要用空格键
键这样的空白符来进行分隔
注意
这是一个
列表而不是
下的键值对映射
因此第一行使用
线开始
如果你仅仅是希望控制认证
而不想管理授权
那么可以设置每个用户就可以访问所有的端点
那么可以这样设置
如果安全属性使用的是基本认证
那么为用户设置角色是很必要的
例如
授权
和仪表板的行为特性
授权启用后
仪表板
和
将根据用户所分配的角色而给用户看到和使用不同的功用
如果用户没有相应的角色
命令将被标记为不可使用
如果用户没有相应的角色授权
那么仪表板的用户界面将不显示对应的页面或者页面元素
基于
授权
当配置
来进行身份验证时
可以同时配置
和
在没有特别指定的情况下
这个属性
包含了角色的名字
是默认角色
如需进一步信息
请查看
的
服务器
参考指南
允许可以将
集成到单一登录
的环境当中
以下
种
授权模式可以供使用
授权码
用于图形用户界面
浏览器
的整合
你将被重定向到
认证服务
密码
会使用到
你可以使用用户名和密码登录
客户端凭据
直接从
提供者获取访问令牌
通过使用
发送到数据流服务器
风格的端点可以使用
种方式访问
基本认证
使用
密码授权类型
基于
服务来认证
访问令牌
使用
客户端证书授权类型
在设置身份验证时
强烈建议启用
尤其是在生产环境中
你可以通过在
配置文件或是通过环境变量来打开
认证
在
的配置节中设置了
这个属性
将会使系统启用
的安全认证
你可以用
来验证基本认证是否正常启用
返回的结果应该是可以使用的
风格的端点列表
除了基本身份验证外
还可以提供访问令牌以访问
可以从
提供者检索
访问令牌
然后通过访问令牌
使用
发送给服务器
端点的授权
认证选项使用的授权规则与
传统认证
选项的一样
授权规则在
文件当中
由于安全角色的定义是与具体的环境相关联的
默认情况下会将所有角色赋与
认证的用户
框架使用的授权对应类是
系统可以自定义行为特征
这需要提供自己的
来扩展
的基于
的
接口
在这种情况下
自定义
定义优先于
提供的
使用
的
认证
如果
提供者提供了密码授权类型
那么可以用下边的方式来启动
记住
当
的认证启用后
提供者
必须
支持
密码授权类型
不然就没法使用
了
在
当中
还可以使用以下的方式来提供使用证书
运行成功的话
你会看到下边的输出
认证示例
使用
的两个简单注解属性
可以很容易地建立
的服务器
下边的
链接内容是一个相应的示例
签出这个代码
编译好后运行起来
同时可以把
和
配置到
里
使用
进行认证
如果你想使用一个现成的
提供商
这里有一个基于
的例子
首先你需要在你的
帐号下新建一个应用
地址如下
当你在本地机器运行
的时候
的配置类似下面这样
上注册应用程序
在
这一项里
你可以输入
的登录
类似
配置
的
和
到
当中
并不支持
的密码授权类型
的
没法使用
来进行认证
配置
管理端点的安全性
当启用安全设置时
请确保
管理端点的也启用了安全设置
您可以
里添加配置来启用管理端点的安全性
如果没有明确地设置管理端点的安全性
那么就算
被设置为
了
风格的端点也还是不安全的
监控和管理
服务器本身是一个包括
了
功能库的
应用程序
它准备好了一系列的现成功能帮助你监控和管理你的应用程序
功能库在路径
下添加了
端点
这也是个其它可用端点的发现页面
例如
有一个健康状态的端点可以展现应用程序
的健康状态信息和来自
的环境变量列表
默认情况下
只有健康状态和应用程序信息的端点是可以访问的
其它的端点是比较
敏感的
需要
明确通过配置来启用
如果你需要启用敏感的端点
那么你应该配置服务器端点的安全性
使信息不让未经身份验证的用户访问到
本地数据流服务器默认情况下已禁用安全设置
所有可用的
功能库的端点是可以访问的
数据流服务器如果启用了分析功能
那么它需要相应的关系数据库和
服务器做支撑
数据流服务器会自动配置
和
这两种服务的健康状态也纳入到服务器的整体健康状况
可以通过健康状态端点查看
管理
将
端点功能可视化并和它进行交互的好方法
是将
功能库集成到
服务器中
您可以通过以下几个简单的步骤
来创建
应用程序
将
服务器作为
服务器客户端的方法是
通过添加一个依赖到数据流服务器的
文件中
然后添加额外的配置属性
你将需要克隆
服务器的
库以便修改
文件
在
库中有每个版本的标签
添加这种依赖会导致
界面增加了对应每个
端点的标签页
界面
如果需要与
和日志记录进行交互
就需要进行额外的配置
可以通过
的文档获取更多信息
因为
应用程序信息
和
健康状态
端点是未经身份验证的用户可以直接访问的
你应该启用数据流服务器的安全性设置
同时配置
服务器的安全性
以便能安全地访问
终点
监控部署的应用程序
部署的应用程序基于
的
包含了一些用于监控应用程序的功能特性
每个部署的应用程序中都包含了
监测
和
应用程序多个
端点
值得一提的是
端点包含一系列的计数器和度量
如
请求的
系统指标
的
类似
的统计
指标的
和
消息通道指标的
如信息速率
可以让你
添加自己的指标到
端点下
一种方法是通过注册
接口的实现类
另一种方法是通过集成
的
和
接口用于发送数据给展现
分析这些数据的组件
有输出指标到
和
的相应实现类
这些实现类可以直接使用
还有一些额外的
项目提供了将指标数据发送到外部系统的功能
提供了
用于通过
发送指标数据到消息中间件
订阅指标数据源和聚合
应用程序发布的指标消息
它有一个
端点用于访问聚合后的指标
提供
将指标数据写入到日志文件当中
提供
将数据写入到
提供了创建
应用时最常用的应用程序
它在
项目得到大量使用
使用
和
服务器时的体系结构如下所示
体系结构
系统自带一个可用于所有支持
的
的指标收集器
包
你可以在项目页面上找到编译和运行指标收集器的更多信息
数据流服务器现在接受
这个可选的属性
这个属性指向部署好的指标收集器应用程序的
例如
如果您运行的指标收集器在本机的
端口
然后可以用以下命令来启动服务器
本地的例子
指标收集器可以通过基于用户名和密码的
基本
身份验证来进行安全保护
设置用户名和密码
使用属性
和
如果需要将每个应用程序的指标公布出来
那么设置
属性即可
目的
设置
当在数据流中部署应用程序时
可以将其设置为任何其他应用程序的属性
如果希望
中的所有应用程序都能发布出指标数据
那么可以在数据流服务器级别上设置它
用
这个名称作为指标发布名称是一个很
不错的选择
因为指标收集器都是默认订阅
这个发布名称的数据
另一个常见的配置指标名称的方法是使用部署属性
以下是
这个
流应用程序的例子
它使用了
当中的
和
应用程序
指标收集器在
端点
下以
格式暴露了聚合后的指标
数据流服务器以两种不同的方式访问这个端点
首先是通过暴露一个
端点来代理指标收集器的端点
用户界面在为每个流应用程序显示数据流图中的消息处理速率时
会调用这个暴露的端点
同时用户界面当中的
标签页暴露的
端点本身和
当中的用于显示消息处理速率的
命令
也都会调用这个端点
数据流的消息处理速率
默认情况下
数据流会设置下边这个属性的值
如果这些应用程序的属性值列表是需要进行聚合的
它也会同时设置下边这个属性
由于数据流只显示瞬时输入和输出通道消息速率
默认情况下
所有在
端点下的指标值都是发送相关的
这会降低消息的有效负载统计
但不影响功能
当需要展现这些指标值时
用于跟踪特定应用程序
数据流也暴露出
这个
属性
这个
属性
它的
值是平台相关的
注意
您可以通过设置来重写这些默认值
就像任何应用程序的属性值一样
数据流不会提供它自己实现的功能来存储和可视化历史指标数据
我们将通过提供一个导出器应用程序来集成现有的
系统
该应用程序会处理那些与指标收集器同样来源的消息
并将它们写入到现有的
系统中
我们支持哪个特定的
系统是由用户需求来驱动的
作为例子
我们将开发一个结合了开源的
前端的
导出器
日志和
指标器
如果你希望部署的应用程序绕过指标收集器提供的集中式指标列表
你可以使用
和
当中的指标写入器
数据流
项目通过
为
指标的输出提供了基础
它提供了
来设置写入过程和常用功能
如定义一个更适合当前环境的有特定名称前缀的指标名称
例如
指标名称除了包含应用程序的名称和它所属的流
任务名称外
你可能还希望名称当中包含应用程序正在运行的区域名称
同时项目还包括了
功能类
可以将指标存储到日志文件中
日志文件通常被应用监控工具所利用
如
在那里日志可以被进一步处理
用于创建应用程序的性能仪表板
要利用此功能
您需要在您的流和任务应用程序中添加额外的依赖项
你可以使用
来可以定制自己任务流的应用程序
用它来先生成项目
然后添加你需要使用的
实现类到生成的
文件中
数据流
项目页面上的文档提供了更多你所需的相关信息
日记本
著作权归作者所有
举报文章
下载
生成长微博图片
更多分享
为开发人员提供了快速构建分布式系统中一些常见模式的工具
例如配置管理
服务发现
断路器
智能路由
微代理
控制总线
分布式系统的协调导致了样板模式
使用
开发人员可以快速地支持实现这些模式的服务和应用程序
他们将在任何分布式
卡卡罗
参考指南
参考指南
介绍
转载自
带目录浏览地址
毛宇鹏
构建微服务架构之九
消息总线
本文参考了
问题
如何实现对配置信息的实时更新
虽然
我们已经能够通过
接口和
仓库的
附录
属性大全
红楼梦中人
瑞珠
宝珠
在第十三回出现
秦可卿死封龙禁尉
王熙凤协理宁国府
这一回倒是来了好多人
发生了好多事
毕竟普通人家办丧事就够麻烦了
更不要说贾府这个大家族
而且死的是贾府中的主子
所以丧礼尤为重大
看看给秦可卿准备的棺材就知道了
当然瑞珠宝珠也是在这一回出现
瑞珠
深巷梨花
小象
衣衣
就静静的呆在小暖窝里
看着天上的阳光幻成五角星
我是一个即将踏上孤独旅程的小象
衣衣
离开家并不是我的本意
毕竟我也没啥宏伟抱负
我的梦想和现代少男少女一样过着宅人且不愁吃不愁穿的米虫生活
我一点也不觉得自己可耻
我骄傲我任性我自豪
别以为不米虫的奋斗青年有多高尚
还不
我是张卷毛
手帐
分享一个哈士奇简笔画小教程
八点
才醒
一脸懵逼
迟到了整整一个小时呀
在网上看到的小教程
觉得很有趣
分享给大家
下面也有我尝试画的过程
大家觉得动图太快看不清的话
可以滑下去看看我的
原谅我很穷
只有一个五毛的硬币
两个鄙视的小眼神
毛色的分界
画上眉毛
鼻子
耳朵和嘴巴
神奇宝贝丫
生命里自带阳光
心里就有爱
最近总在朋友圈看到一张贵阳某地夜景的图
上面配的文字是这样的
贵阳是一座没有爱的城市
看到这句话时我在心里问了下自己
真是这样吗
也没那么薄情吧
爱还是有的
就算情况真的坏到没人爱我们还可以自己爱自己
我坚信爱好自己的人一定不缺人爱
或许在这座城市
很多人还在孤独的为
艾墨
让你失望了
我一点都不好人
小的时候
最恐怖的话是
叫你家长来高中的时候
最恐怖的话是
明天考试到了大学
最恐怖的话恐怕就是
收到请回复
大学参加学生会社团什么的后
最常收到的大概就是
收到请回复
这五个字了
这往往就意味着
小朋友
你的
小假期
没有了
小朋友
该起来做任务了
小朋友
大大需要你